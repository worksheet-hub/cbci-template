<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê°œë… ê¸°ë°˜ íƒêµ¬ í”„ë¡œì íŠ¸ ì„¤ê³„ ì›¹í•™ìŠµì§€</title>
<style>
  /* ===== CSS Variables ===== */
  :root {
    --blue: #2E75B6;
    --blue-light: #e8f0fe;
    --blue-dark: #1a3a5c;
    --green: #2E8B6E;
    --green-light: #e6f4ee;
    --green-dark: #1a4a38;
    --brown: #B87333;
    --brown-light: #fbf0e4;
    --brown-dark: #5a3010;
    --gray-50: #f8f9fa;
    --gray-100: #f1f3f5;
    --gray-200: #e9ecef;
    --gray-300: #dee2e6;
    --gray-400: #ced4da;
    --gray-500: #adb5bd;
    --gray-600: #868e96;
    --gray-700: #495057;
    --gray-800: #343a40;
    --gray-900: #212529;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.08);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
    --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
    --radius-sm: 6px;
    --radius-md: 10px;
    --radius-lg: 14px;
    --transition: all 0.2s ease;
  }

  /* ===== Print ===== */
  @page { size: A4; margin: 15mm 18mm; }
  @media print {
    body { background: #fff !important; padding: 0 !important; }
    .toolbar, .add-row-btn, .remove-row-btn, .section-actions, .no-print { display: none !important; }
    .page-break { page-break-before: always; }
    .no-break { page-break-inside: avoid; }
    .worksheet-container { max-width: 100%; box-shadow: none; border: none; padding: 20px; }
    textarea { border: none !important; resize: none !important; overflow: hidden !important; background: transparent !important; box-shadow: none !important; }
    textarea::placeholder { color: transparent !important; }
    .stage-badge, .sub-num, thead, .footer-bar, .hint-box, .ai-tip, .concept-info {
      -webkit-print-color-adjust: exact; print-color-adjust: exact;
    }
    .info-label { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
  }

  /* ===== Reset & Base ===== */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;
    font-size: 10pt;
    color: var(--gray-900);
    line-height: 1.7;
    background: linear-gradient(135deg, #f5f7fa 0%, #eef1f5 100%);
    min-height: 100vh;
    padding: 0;
  }

  /* ===== Toolbar ===== */
  .toolbar {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--gray-200);
    padding: 10px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
  }
  .toolbar-left {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 700;
    color: var(--blue-dark);
    font-size: 11pt;
  }
  .toolbar-left .logo-icon {
    width: 32px; height: 32px;
    background: linear-gradient(135deg, var(--blue), #4a9ade);
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-size: 14pt; font-weight: 900;
  }
  .toolbar-right {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
  }
  .tb-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 16px;
    border: none;
    border-radius: var(--radius-sm);
    font-size: 9.5pt;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    white-space: nowrap;
  }
  .tb-btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-md); }
  .tb-btn:active { transform: translateY(0); }
  .tb-btn-primary {
    background: linear-gradient(135deg, var(--blue), #4a9ade);
    color: #fff;
  }
  .tb-btn-secondary {
    background: var(--gray-100);
    color: var(--gray-700);
    border: 1px solid var(--gray-300);
  }
  .tb-btn-success {
    background: linear-gradient(135deg, var(--green), #3aab8a);
    color: #fff;
  }
  .tb-btn-danger {
    background: var(--gray-100);
    color: #e03131;
    border: 1px solid #ffc9c9;
  }
  .tb-btn-danger:hover { background: #fff5f5; }

  /* ===== Container ===== */
  .worksheet-container {
    max-width: 860px;
    margin: 24px auto;
    background: #fff;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    padding: 36px 40px;
    border: 1px solid var(--gray-200);
  }

  /* ===== Header ===== */
  .doc-header {
    border-top: 5px solid var(--blue);
    padding-top: 18px;
    margin-bottom: 20px;
  }
  .doc-header .corner-label {
    font-size: 8pt;
    color: var(--gray-500);
    font-style: italic;
    letter-spacing: 0.3px;
    text-align: right;
    margin-bottom: 4px;
  }
  .doc-header h1 {
    font-size: 18pt;
    font-weight: 900;
    color: var(--blue-dark);
    letter-spacing: -0.5px;
    margin-bottom: 8px;
  }
  .subtitle-row {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 9.5pt;
    color: var(--gray-600);
    flex-wrap: wrap;
    padding-bottom: 14px;
    border-bottom: 2px solid var(--gray-200);
  }
  .stage-pill {
    display: inline-block;
    padding: 3px 12px;
    border-radius: 14px;
    font-size: 8.5pt;
    font-weight: 700;
    letter-spacing: 0.2px;
  }
  .pill-s1 { background: var(--blue); color: #fff; }
  .pill-s2 { background: var(--green); color: #fff; }
  .pill-s3 { background: var(--brown); color: #fff; }
  .arrow-sep { color: var(--gray-400); font-size: 10pt; }

  /* ===== Stage Headers ===== */
  .stage-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 28px 0 14px 0;
  }
  .stage-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 54px; height: 54px;
    border-radius: 50%;
    font-size: 8.5pt;
    font-weight: 800;
    color: #fff;
    flex-shrink: 0;
    line-height: 1.2;
    text-align: center;
    box-shadow: var(--shadow-sm);
  }
  .badge-s1 { background: linear-gradient(135deg, var(--blue), #4a9ade); }
  .badge-s2 { background: linear-gradient(135deg, var(--green), #3aab8a); }
  .badge-s3 { background: linear-gradient(135deg, var(--brown), #d4904a); }
  .stage-title {
    font-size: 14pt;
    font-weight: 900;
    letter-spacing: -0.3px;
  }
  .stage-title.s1 { color: var(--blue); }
  .stage-title.s2 { color: var(--green); }
  .stage-title.s3 { color: var(--brown); }
  .stage-divider {
    flex: 1;
    height: 3px;
    border-radius: 2px;
  }
  .div-s1 { background: linear-gradient(to right, var(--blue), var(--blue-light)); }
  .div-s2 { background: linear-gradient(to right, var(--green), var(--green-light)); }
  .div-s3 { background: linear-gradient(to right, var(--brown), var(--brown-light)); }

  /* ===== Sub Headers ===== */
  .sub-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 18px 0 8px 0;
  }
  .sub-num {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 22px; height: 22px;
    border-radius: 50%;
    font-size: 8.5pt;
    font-weight: 700;
    color: #fff;
    flex-shrink: 0;
  }
  .num-s1 { background: var(--blue); }
  .num-s2 { background: var(--green); }
  .num-s3 { background: var(--brown); }
  .sub-title {
    font-size: 11.5pt;
    font-weight: 800;
    color: var(--gray-800);
  }

  /* ===== Info Grid ===== */
  .info-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
    border: 1px solid #c8d4e8;
    border-radius: var(--radius-sm);
    overflow: hidden;
    margin: 10px 0;
  }
  .info-item {
    display: flex;
    border-bottom: 1px solid #dde4ef;
    border-right: 1px solid #dde4ef;
    min-height: 36px;
  }
  .info-item:nth-child(2n) { border-right: none; }
  .info-item:nth-last-child(-n+2) { border-bottom: none; }
  .info-label {
    background: #EEF3FA;
    font-weight: 700;
    font-size: 9pt;
    color: var(--blue);
    padding: 6px 12px;
    white-space: nowrap;
    display: flex;
    align-items: center;
    min-width: 100px;
    border-right: 1px solid #dde4ef;
  }
  .info-value {
    flex: 1;
    padding: 0;
  }
  .info-value textarea {
    width: 100%;
    height: 100%;
    min-height: 36px;
    border: none;
    padding: 6px 10px;
    font-size: 9.5pt;
    font-family: inherit;
    line-height: 1.6;
    resize: none;
    background: transparent;
  }
  .info-value textarea:focus { outline: none; background: #fafbff; }
  .info-item.full { grid-column: 1 / -1; border-right: none; }

  /* ===== Tables ===== */
  table {
    width: 100%;
    border-collapse: collapse;
    margin: 8px 0;
    font-size: 9.5pt;
  }
  th {
    font-weight: 700;
    text-align: center;
    font-size: 9pt;
    padding: 8px 10px;
    vertical-align: middle;
  }
  td {
    border: 1px solid #c8cdd6;
    padding: 0;
    vertical-align: top;
  }
  th { border: 1px solid #b0b8c8; }

  .t-s1 th { background: #dce8f5; color: var(--blue-dark); }
  .t-s1 td { border-color: #c0cfe8; }
  .t-s2 th { background: #d4ede4; color: var(--green-dark); }
  .t-s2 td { border-color: #b8d8c8; }
  .t-s3 th { background: #f5e8d4; color: var(--brown-dark); }
  .t-s3 td { border-color: #e0c8a8; }
  .t-kpt th { background: var(--gray-100); color: var(--gray-800); }
  .t-kpt td { border-color: #ccc; }

  /* ===== Textarea in cells ===== */
  td textarea {
    width: 100%;
    min-height: 48px;
    border: none;
    padding: 8px 10px;
    font-size: 9.5pt;
    font-family: inherit;
    line-height: 1.65;
    resize: vertical;
    background: transparent;
    transition: background 0.15s;
  }
  td textarea:focus {
    outline: none;
    background: rgba(46, 117, 182, 0.03);
  }
  td textarea::placeholder {
    color: var(--gray-400);
    font-style: italic;
  }
  td.cell-center textarea {
    text-align: center;
  }

  /* ===== GRASPS & WHERETO ===== */
  .grasps-letter {
    font-weight: 900;
    font-size: 15pt;
    color: var(--green);
    text-align: center;
    vertical-align: middle;
    padding: 8px !important;
    width: 50px;
  }
  .whereto-letter {
    font-weight: 900;
    font-size: 14pt;
    color: var(--brown);
    text-align: center;
    vertical-align: middle;
    padding: 8px !important;
    width: 50px;
  }
  .grasps-meaning, .whereto-meaning {
    vertical-align: middle;
    padding: 8px 10px !important;
    font-size: 9pt;
  }

  /* ===== Hints & Tips ===== */
  .hint-box {
    background: #f0f5fc;
    border-left: 4px solid var(--blue);
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    padding: 10px 14px;
    font-size: 9pt;
    color: #3a4a6a;
    margin: 8px 0;
    line-height: 1.7;
  }
  .ai-tip {
    background: #fffbec;
    border-left: 4px solid #e0a800;
    border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
    padding: 10px 14px;
    font-size: 9pt;
    color: #5a4800;
    font-style: italic;
    margin: 6px 0 10px 0;
    line-height: 1.7;
    display: flex;
    align-items: flex-start;
    gap: 10px;
    justify-content: space-between;
  }
  .ai-tip b { color: #7a5f00; font-style: normal; }
  .ai-tip .nlm-link {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 4px 12px;
    background: linear-gradient(135deg, #fbbc04, #f9ab00);
    color: #fff;
    font-size: 8pt;
    font-weight: 700;
    font-style: normal;
    border-radius: 14px;
    text-decoration: none;
    white-space: nowrap;
    flex-shrink: 0;
    transition: var(--transition);
    box-shadow: 0 1px 4px rgba(249, 171, 0, 0.3);
  }
  .ai-tip .nlm-link:hover {
    transform: translateY(-1px);
    box-shadow: 0 3px 8px rgba(249, 171, 0, 0.4);
    background: linear-gradient(135deg, #f9ab00, #e69900);
  }

  /* ===== Concept Info ===== */
  .concept-info {
    background: #f5f8fd;
    border: 1px solid #c8d8ee;
    border-radius: var(--radius-sm);
    padding: 14px 18px;
    margin: 10px 0;
    font-size: 9pt;
    line-height: 1.8;
  }
  .concept-info h4 {
    color: var(--blue);
    font-size: 10pt;
    margin-bottom: 8px;
  }
  .concept-info .item-title { font-weight: 700; color: var(--gray-800); margin-top: 6px; display: block; }
  .concept-info .indent { padding-left: 16px; color: var(--gray-700); margin: 2px 0; display: block; }

  /* ===== Input Line ===== */
  .input-line-wrap {
    margin: 6px 0;
  }
  .input-line-wrap label {
    display: block;
    font-size: 9.5pt;
    font-weight: 700;
    color: var(--blue-dark);
    margin-bottom: 4px;
  }
  .input-line-wrap label span {
    font-weight: 400;
    color: var(--gray-600);
    font-size: 8.5pt;
  }
  .input-line-wrap textarea {
    width: 100%;
    min-height: 44px;
    border: 1px dashed var(--gray-400);
    border-radius: var(--radius-sm);
    padding: 10px 14px;
    font-size: 10pt;
    font-family: inherit;
    line-height: 1.7;
    resize: vertical;
    transition: var(--transition);
  }
  .input-line-wrap textarea:focus {
    outline: none;
    border-color: var(--blue);
    border-style: solid;
    box-shadow: 0 0 0 3px rgba(46, 117, 182, 0.1);
    background: #fafbff;
  }
  .input-line-wrap textarea::placeholder {
    color: var(--gray-400);
    font-style: italic;
  }

  /* ===== Lens Table ===== */
  .lens-th {
    background: #dce8f5;
    color: var(--blue-dark);
    font-weight: 700;
    font-size: 9pt;
    padding: 10px 14px !important;
    vertical-align: middle;
    border: 1px solid #b0c4de;
    width: 28%;
  }
  .lens-td {
    border: 1px solid #c0cfe8;
    padding: 0;
    vertical-align: top;
  }
  .lens-td textarea {
    min-height: 52px;
  }

  /* ===== Add/Remove Row Buttons ===== */
  .table-actions {
    display: flex;
    gap: 8px;
    margin: 6px 0 4px 0;
  }
  .add-row-btn {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 5px 14px;
    border: 1px dashed var(--gray-400);
    border-radius: var(--radius-sm);
    background: var(--gray-50);
    color: var(--gray-600);
    font-size: 8.5pt;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
  }
  .add-row-btn:hover {
    border-color: var(--blue);
    color: var(--blue);
    background: var(--blue-light);
  }
  .remove-row-btn {
    position: absolute;
    right: -28px;
    top: 50%;
    transform: translateY(-50%);
    width: 22px; height: 22px;
    border: none;
    border-radius: 50%;
    background: #fee2e2;
    color: #e03131;
    font-size: 12px;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
  }
  .remove-row-btn:hover { background: #fca5a5; }
  tr:hover .remove-row-btn { display: inline-flex; }
  tr { position: relative; }

  /* ===== Description text ===== */
  .desc-text {
    font-size: 9pt;
    color: var(--gray-600);
    font-style: italic;
    margin: 4px 0 10px 4px;
  }

  /* ===== Page Labels ===== */
  .page-label {
    text-align: right;
    font-size: 8pt;
    color: var(--gray-400);
    margin-bottom: 6px;
    font-style: italic;
  }

  /* ===== Footer ===== */
  .footer-bar {
    margin-top: 28px;
    padding: 10px 18px;
    background: linear-gradient(135deg, var(--blue-dark), #2a5580);
    color: #fff;
    border-radius: var(--radius-sm);
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 8.5pt;
  }
  .footer-bar .left { font-weight: 700; letter-spacing: 0.3px; }
  .footer-bar .right { opacity: 0.75; font-style: italic; }

  /* ===== Strand center ===== */
  .strand-label {
    text-align: center;
    vertical-align: middle;
    font-weight: 700;
    color: var(--brown);
    background: #fef8f0;
    font-size: 9pt;
    padding: 8px !important;
  }
  .strand-label textarea {
    text-align: center;
    font-weight: 700;
    color: var(--brown);
    background: transparent;
  }

  /* ===== Checkbox Cells ===== */
  .check-cell {
    padding: 8px 10px !important;
  }
  .check-label {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    margin-bottom: 6px;
    font-size: 9pt;
    cursor: pointer;
  }
  .check-label input[type="checkbox"] {
    width: 16px; height: 16px;
    margin-top: 2px;
    accent-color: var(--brown);
    cursor: pointer;
  }

  /* ===== Save Status ===== */
  .save-status {
    font-size: 8pt;
    color: var(--gray-500);
    padding: 4px 10px;
    border-radius: 12px;
    background: var(--gray-100);
    display: inline-flex;
    align-items: center;
    gap: 4px;
  }
  .save-status.saved { color: var(--green); background: #e6f4ee; }

  /* ===== Toast Notification ===== */
  .toast {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: var(--gray-800);
    color: #fff;
    padding: 12px 24px;
    border-radius: var(--radius-md);
    font-size: 9.5pt;
    font-weight: 600;
    box-shadow: var(--shadow-lg);
    z-index: 200;
    opacity: 0;
    transition: all 0.3s ease;
  }
  .toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }

  /* ===== Responsive ===== */
  @media (max-width: 900px) {
    .worksheet-container { padding: 20px; margin: 12px; border-radius: var(--radius-md); }
    .toolbar { padding: 8px 16px; flex-wrap: wrap; }
    .toolbar-left { font-size: 10pt; }
    .tb-btn { padding: 6px 12px; font-size: 8.5pt; }
    .info-grid { grid-template-columns: 1fr; }
    .info-item:nth-child(2n) { border-right: none; }
    .info-item { border-right: none !important; }
  }

  /* ===== Autogrow textarea style ===== */
  textarea.autogrow {
    overflow: hidden;
  }
</style>
</head>
<body>

<!-- ===== Toolbar ===== -->
<div class="toolbar no-print">
  <div class="toolbar-left">
    <div class="logo-icon">C</div>
    <span>CBCI ì›¹í•™ìŠµì§€</span>
  </div>
  <div class="toolbar-right">
    <span class="save-status" id="saveStatus">
      <span id="saveIcon">ğŸ’¾</span> <span id="saveText">ìë™ ì €ì¥ ëŒ€ê¸°</span>
    </span>
    <button class="tb-btn tb-btn-secondary" onclick="resetAll()" title="ëª¨ë“  ì…ë ¥ ì´ˆê¸°í™”">
      ğŸ—‘ ì´ˆê¸°í™”
    </button>
    <button class="tb-btn tb-btn-secondary" onclick="downloadHTML()" title="HTML íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ">
      ğŸ“„ HTML ì €ì¥
    </button>
    <button class="tb-btn tb-btn-primary" onclick="printPDF()" title="ì¸ì‡„ / PDF ì €ì¥">
      ğŸ–¨ ì¸ì‡„ / PDF
    </button>
  </div>
</div>

<!-- ===== Main Container ===== -->
<div class="worksheet-container" id="worksheetContainer">

  <!-- ===== Cover Header ===== -->
  <div class="doc-header">
    <div class="corner-label">ê°œë…ê¸°ë°˜ìˆ˜ì—…ì„¤ê³„ AIë¡œ ë‚ ê°œë¥¼ ë‹¬ë‹¤</div>
    <h1>ê°œë… ê¸°ë°˜ íƒêµ¬ í”„ë¡œì íŠ¸ ì„¤ê³„ ì›Œí¬ì‹œíŠ¸</h1>
    <div class="subtitle-row">
      <span>ë°±ì›Œë“œ ì„¤ê³„ 3ë‹¨ê³„</span>
      <span class="arrow-sep">:</span>
      <span class="stage-pill pill-s1">1ë‹¨ê³„ ë°”ë¼ëŠ” ê²°ê³¼</span>
      <span class="arrow-sep">â†’</span>
      <span class="stage-pill pill-s2">2ë‹¨ê³„ ì¦ê±° ê²°ì •</span>
      <span class="arrow-sep">â†’</span>
      <span class="stage-pill pill-s3">3ë‹¨ê³„ í•™ìŠµ ê²½í—˜</span>
    </div>
  </div>

  <!-- ===== Basic Info ===== -->
  <div class="sub-header">
    <span class="sub-title" style="color:var(--blue-dark);">ğŸ“‹ ê¸°ë³¸ ì •ë³´</span>
  </div>

  <table class="t-s1" id="basicInfoTable">
    <thead>
      <tr>
        <th style="width:14%">êµê³¼</th>
        <th style="width:20%">ì„±ì·¨ê¸°ì¤€ ì½”ë“œ</th>
        <th style="width:51%">ì„±ì·¨ê¸°ì¤€ ë‚´ìš© (ìš”ì•½)</th>
        <th style="width:15%">ì°¨ì‹œ</th>
      </tr>
    </thead>
    <tbody id="basicInfoBody">
      <tr>
        <td><textarea class="autogrow" placeholder="ì˜ˆ: ë„ë•" data-field="subject-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="[4ë„02-01]" data-field="code-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="íš¨, ìš°ì• ì˜ ì˜ë¯¸ì™€ í•„ìš”ì„±ì„ ì´í•´í•˜ê³ â€¦" data-field="content-1"></textarea></td>
        <td class="cell-center"><textarea class="autogrow" placeholder="5" data-field="hours-1" style="text-align:center;"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="table-actions no-print">
    <button class="add-row-btn" onclick="addRow('basicInfoBody', ['subject','code','content','hours'], 4)">+ ì„±ì·¨ê¸°ì¤€ í–‰ ì¶”ê°€</button>
  </div>

  <div class="info-grid">
    <div class="info-item">
      <div class="info-label">ì´ ì°¨ì‹œ</div>
      <div class="info-value"><textarea class="autogrow" placeholder="ì˜ˆ: 15ì°¨ì‹œ" data-field="total-hours"></textarea></div>
    </div>
    <div class="info-item">
      <div class="info-label">í•™ë…„</div>
      <div class="info-value"><textarea class="autogrow" placeholder="ì˜ˆ: 3í•™ë…„" data-field="grade"></textarea></div>
    </div>
    <div class="info-item">
      <div class="info-label">ê¸°ê°„</div>
      <div class="info-value"><textarea class="autogrow" placeholder="ì˜ˆ: 3ì›” 2ì£¼ ~ 4ì›” 1ì£¼" data-field="period"></textarea></div>
    </div>
    <div class="info-item">
      <div class="info-label">í˜‘ë ¥íŒ€ì›</div>
      <div class="info-value"><textarea class="autogrow" placeholder="íŒ€ì› ì´ë¦„" data-field="team"></textarea></div>
    </div>
    <div class="info-item full">
      <div class="info-label">í”„ë¡œì íŠ¸/ë‹¨ì›ëª…</div>
      <div class="info-value"><textarea class="autogrow" placeholder="í”„ë¡œì íŠ¸ ë˜ëŠ” ë‹¨ì› ì´ë¦„ ì…ë ¥" data-field="project-name"></textarea></div>
    </div>
    <div class="info-item full">
      <div class="info-label">ê´€ë ¨ í•µì‹¬ì—­ëŸ‰</div>
      <div class="info-value"><textarea class="autogrow" placeholder="ê³µê°ì†Œí†µ / ì°½ì˜ìœµí•© / ìê¸°ê´€ë¦¬ / ê³µë™ì²´ (ëŒ€êµ¬ 4ëŒ€)" data-field="competency"></textarea></div>
    </div>
  </div>

  <div class="ai-tip" style="background:#f0f0ff; border-left-color:#5c6bc0; color:#3a3a6a;">
    <span><b>ğŸ“˜ ëŒ€êµ¬ë¯¸ë˜ì—­ëŸ‰</b>&nbsp; ê³µê°ì†Œí†µÂ·ì°½ì˜ìœµí•©Â·ìê¸°ê´€ë¦¬Â·ê³µë™ì²´ â€” ëŒ€êµ¬ 4ëŒ€ í•µì‹¬ì—­ëŸ‰ì— ëŒ€í•œ ë°°ê²½ì§€ì‹ê³¼ ìƒì„¸ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.</span>
    <a class="nlm-link" style="background:linear-gradient(135deg,#5c6bc0,#7986cb); box-shadow:0 1px 4px rgba(92,107,192,0.3);" href="https://dge0110-my.sharepoint.com/:p:/g/personal/plusiam_o365_dg-gamcheon_es_kr/IQD9wso7M5-dS5qSfjfw_xQgAZoIqph_RDWTrA3wMgck0EE?e=rudY6B" target="_blank" rel="noopener">ğŸ“˜ ì—­ëŸ‰ ìë£Œ ì—´ê¸°</a>
  </div>

  <div class="hint-box">ğŸ’¡ ì„±ì·¨ê¸°ì¤€ ì½”ë“œë€? [4ë„02-01] = 4í•™ë…„, ë„ë•, 02ë²ˆì§¸ ì˜ì—­, 01ë²ˆ ê¸°ì¤€. ìœµí•© í”„ë¡œì íŠ¸ëŠ” 2ê°œ ì´ìƒ êµê³¼ì˜ ì„±ì·¨ê¸°ì¤€ì„ í•¨ê»˜ ì”ë‹ˆë‹¤.</div>
  <div class="ai-tip"><span><b>ğŸ¤– NotebookLM</b>&nbsp; êµìœ¡ê³¼ì • ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•œ ë’¤, 'ì´ˆ3 ê°€ì¡±ì— ê´€í•œ ë„ë•ê³¼ ì„±ì·¨ê¸°ì¤€ ì°¾ì•„ì¤˜'ì²˜ëŸ¼ ì§ˆë¬¸í•˜ë©´ ê´€ë ¨ ì„±ì·¨ê¸°ì¤€ì„ ë¹ ë¥´ê²Œ ê²€ìƒ‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span><a class="nlm-link" href="https://notebooklm.google.com/notebook/bd163358-a9d5-45f2-8007-5eacab2f2dd4" target="_blank" rel="noopener">ğŸ“’ NotebookLM ì—´ê¸°</a></div>

  <!-- ===== Stage 1 ===== -->
  <div class="stage-header">
    <div class="stage-badge badge-s1">1<br>ë‹¨ê³„</div>
    <div class="stage-title s1">ë°”ë¼ëŠ” ê²°ê³¼ í™•ì¸</div>
    <div class="stage-divider div-s1"></div>
  </div>

  <div class="sub-header">
    <span class="sub-num num-s1">â‘ </span>
    <span class="sub-title">êµìœ¡ê³¼ì • ë¶„ì„ (êµê³¼ë³„)</span>
  </div>
  <p class="desc-text">ê° ì°¸ì—¬ êµê³¼ì˜ í•µì‹¬ ì•„ì´ë””ì–´ì™€ ë‚´ìš©ìš”ì†Œë¥¼ êµê³¼ë³„ë¡œ ë¶„í•´í•©ë‹ˆë‹¤.</p>

  <table class="t-s1" id="curriculumTable">
    <thead>
      <tr>
        <th style="width:11%">êµê³¼</th>
        <th style="width:24%">í•µì‹¬ ì•„ì´ë””ì–´<br>(ì˜ì—­ ìˆ˜ì¤€, ì›ë¬¸)</th>
        <th style="width:21%">ì§€ì‹Â·ì´í•´<br>(Know)</th>
        <th style="width:22%">ê³¼ì •Â·ê¸°ëŠ¥<br>(Do)</th>
        <th style="width:22%">ê°€ì¹˜Â·íƒœë„<br>(Be)</th>
      </tr>
    </thead>
    <tbody id="curriculumBody">
      <tr>
        <td><textarea class="autogrow" placeholder="ë„ë•" data-field="cur-subj-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="í•µì‹¬ ì•„ì´ë””ì–´ ì›ë¬¸ ì…ë ¥" data-field="cur-idea-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì§€ì‹Â·ì´í•´ ìš”ì†Œ" data-field="cur-know-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ê³¼ì •Â·ê¸°ëŠ¥ ìš”ì†Œ" data-field="cur-do-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ê°€ì¹˜Â·íƒœë„ ìš”ì†Œ" data-field="cur-be-1"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="table-actions no-print">
    <button class="add-row-btn" onclick="addRow('curriculumBody', ['cur-subj','cur-idea','cur-know','cur-do','cur-be'], 5)">+ êµê³¼ í–‰ ì¶”ê°€</button>
  </div>
  <div class="hint-box">ğŸ’¡ ìœµí•© í”„ë¡œì íŠ¸ì—ì„œëŠ” êµê³¼ë§ˆë‹¤ í•µì‹¬ ì•„ì´ë””ì–´ì™€ ë‚´ìš©ìš”ì†Œê°€ ë‹¤ë¦…ë‹ˆë‹¤. ê° êµê³¼ì˜ ë‚´ìš© ì²´ê³„í‘œì—ì„œ í•´ë‹¹ ì˜ì—­ì˜ í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ ì°¾ì•„ êµê³¼ë³„ë¡œ ê¸°ë¡í•˜ì„¸ìš”.</div>
  <div class="ai-tip"><span><b>ğŸ¤– NotebookLM</b>&nbsp; 'ë„ë• 4í•™ë…„ ìê¸° ì¡´ì¤‘ ì˜ì—­ì˜ í•µì‹¬ ì•„ì´ë””ì–´ì™€ ë‚´ìš©ìš”ì†Œë¥¼ ì •ë¦¬í•´ì¤˜'ë¼ê³  êµê³¼ë³„ë¡œ ì§ˆë¬¸í•˜ë©´ í•œëˆˆì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span><a class="nlm-link" href="https://notebooklm.google.com/notebook/bd163358-a9d5-45f2-8007-5eacab2f2dd4" target="_blank" rel="noopener">ğŸ“’ NotebookLM ì—´ê¸°</a></div>

  <!-- ===== Page 2 ===== -->
  <div class="page-break"></div>
  <div class="page-label">1ë‹¨ê³„ ê³„ì†</div>

  <div class="sub-header">
    <span class="sub-num num-s1">â‘¡</span>
    <span class="sub-title">ê°œë… ì„¤ê³„</span>
  </div>

  <table class="t-s1" style="margin-bottom:10px;">
    <tbody>
      <tr>
        <td class="lens-th">ë§¤í¬ë¡œ ê°œë…<br><span style="font-weight:normal;font-size:8pt;">(= ê°œë…ì  ë Œì¦ˆ)<br>ëŒ€êµ¬ 8ëŒ€ / IB 7ê°œ</span></td>
        <td class="lens-td"><textarea class="autogrow" placeholder="ì •ì²´ì„± Â· ì¸ê³¼ê´€ê³„ Â· ê¸°ëŠ¥ Â· í˜•íƒœ Â· ë³€í™” Â· ê´€ì  Â· ìƒí˜¸ì‘ìš© Â· ì±…ì„ â€” ìœ„ ëª©ë¡ì—ì„œ ë Œì¦ˆê°€ ë  ê°œë…ì„ ì„ íƒí•˜ì„¸ìš”" data-field="macro-concept"></textarea></td>
      </tr>
      <tr>
        <td class="lens-th">ë§ˆì´í¬ë¡œ ê°œë…<br><span style="font-weight:normal;font-size:8pt;">(êµê³¼ë³„ í•˜ìœ„ ê°œë…)</span></td>
        <td class="lens-td"><textarea class="autogrow" placeholder="ì˜ˆ: íš¨, ìš°ì• , ì¡´ì¤‘, ë°°ë ¤" data-field="micro-concept"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="hint-box">ğŸ’¡ ê°œë…ì˜ ìœ„ê³„: ë§¤í¬ë¡œ ê°œë…(ê°œë…ì  ë Œì¦ˆ, ê°€ì¥ ì¶”ìƒì ) â†’ ë§ˆì´í¬ë¡œ ê°œë…(êµê³¼ë³„ í•˜ìœ„ ê°œë…, êµ¬ì²´ì )</div>
  <div class="ai-tip"><span><b>ğŸ¤– NotebookLM</b>&nbsp; 'ì´ ì„±ì·¨ê¸°ì¤€ë“¤ì„ ê´€í†µí•˜ëŠ” ìƒìœ„ ê°œë…ì€ ë¬´ì—‡ì¼ê¹Œ?'ë¼ê³  ì§ˆë¬¸í•˜ë©´ ë§¤í¬ë¡œ ê°œë…(ë Œì¦ˆ) í›„ë³´ë¥¼ ì œì•ˆë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span><a class="nlm-link" href="https://notebooklm.google.com/notebook/bd163358-a9d5-45f2-8007-5eacab2f2dd4" target="_blank" rel="noopener">ğŸ“’ NotebookLM ì—´ê¸°</a></div>

  <div class="sub-header" style="margin-top:20px;">
    <span class="sub-num num-s1">â‘¢</span>
    <span class="sub-title">ì¤‘ì‹¬ ì•„ì´ë””ì–´ + í•µì‹¬ ì§ˆë¬¸ (ë‹¨ì› ìˆ˜ì¤€, ê° 1ê°œ)</span>
  </div>

  <div class="input-line-wrap">
    <label>ì¤‘ì‹¬ ì•„ì´ë””ì–´ (Central Idea) <span>â€” ë‹¨ì› ì „ì²´ë¥¼ ê´€í†µí•˜ëŠ” ìµœìƒìœ„ ì¼ë°˜í™” 1ê°œ</span></label>
    <textarea class="autogrow" placeholder="ì˜ˆ: ê°€ì¡±ì˜ ì‚¬ë‘ê³¼ í–‰ë³µì€ ì±…ì„ ìˆëŠ” í‘œí˜„ì„ í†µí•´ ê¹Šì–´ì§„ë‹¤." data-field="central-idea"></textarea>
  </div>

  <div class="input-line-wrap" style="margin-top:14px;">
    <label>í•µì‹¬ ì§ˆë¬¸ (Overarching EQ) <span>â€” ë‹¨ì› ì „ì²´ë¥¼ ì´ë„ëŠ” í¬ê´„ì  ì—´ë¦° ì§ˆë¬¸ 1ê°œ</span></label>
    <textarea class="autogrow" placeholder="ì˜ˆ: ê°€ì¡±ì—ê²Œ ì‚¬ë‘ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì™œ ì¤‘ìš”í•˜ë©°, ì–´ë–»ê²Œ í•  ìˆ˜ ìˆì„ê¹Œ?" data-field="essential-question"></textarea>
  </div>

  <div class="hint-box" style="margin-top:10px;">ğŸ’¡ â‘¢ ì¤‘ì‹¬ ì•„ì´ë””ì–´Â·í•µì‹¬ ì§ˆë¬¸ì€ ë‹¨ì›ì˜ 'í° ê·¸ë¦¼'ì…ë‹ˆë‹¤. â‘£ ìŠ¤íŠ¸ëœë“œì˜ í•˜ìœ„ ì•„ì´ë””ì–´Â·ì•ˆë‚´ ì§ˆë¬¸ì´ ì´ë¥¼ êµ¬ì²´í™”í•©ë‹ˆë‹¤.</div>

  <div class="sub-header" style="margin-top:20px;">
    <span class="sub-num num-s1">â‘£</span>
    <span class="sub-title">ìŠ¤íŠ¸ëœë“œë³„ í•˜ìœ„ ì•„ì´ë””ì–´ + ì•ˆë‚´ ì§ˆë¬¸</span>
  </div>

  <table class="t-s1" id="strandTable">
    <thead>
      <tr>
        <th style="width:20%">ìŠ¤íŠ¸ëœë“œ</th>
        <th style="width:40%">í•˜ìœ„ ì•„ì´ë””ì–´ (ì¼ë°˜í™”)</th>
        <th style="width:40%">ì•ˆë‚´ ì§ˆë¬¸ (Guiding Questions)</th>
      </tr>
    </thead>
    <tbody id="strandBody">
      <tr>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 1&#10;(ê°œë… í˜•ì„±)" data-field="strand-name-1" style="text-align:center;font-weight:700;color:#B87333;min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="í•˜ìœ„ ì•„ì´ë””ì–´(ì¼ë°˜í™”) ì…ë ¥" data-field="strand-idea-1" style="min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸ 2~4ê°œ ì…ë ¥" data-field="strand-q-1" style="min-height:60px;"></textarea></td>
      </tr>
      <tr>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 2&#10;(í‘œí˜„ í™•ì¥)" data-field="strand-name-2" style="text-align:center;font-weight:700;color:#B87333;min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="í•˜ìœ„ ì•„ì´ë””ì–´(ì¼ë°˜í™”) ì…ë ¥" data-field="strand-idea-2" style="min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸ 2~4ê°œ ì…ë ¥" data-field="strand-q-2" style="min-height:60px;"></textarea></td>
      </tr>
      <tr>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 3&#10;(í–‰ë™ í™•ì¥/ì „ì´)" data-field="strand-name-3" style="text-align:center;font-weight:700;color:#B87333;min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="í•˜ìœ„ ì•„ì´ë””ì–´(ì¼ë°˜í™”) ì…ë ¥" data-field="strand-idea-3" style="min-height:60px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸ 2~4ê°œ ì…ë ¥" data-field="strand-q-3" style="min-height:60px;"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="table-actions no-print">
    <button class="add-row-btn" onclick="addStrandRow()">+ ìŠ¤íŠ¸ëœë“œ ì¶”ê°€</button>
  </div>
  <div class="hint-box">ğŸ’¡ ê° ìŠ¤íŠ¸ëœë“œì— í•˜ìœ„ ì¼ë°˜í™” 1ê°œ + ì•ˆë‚´ ì§ˆë¬¸(Topical EQ) 2~4ê°œë¥¼ ë°°ì¹˜í•©ë‹ˆë‹¤. 'ê°œë… í˜•ì„± â†’ í‘œí˜„ í™•ì¥ â†’ í–‰ë™ í™•ì¥' íë¦„ì„ ì°¸ê³ í•˜ì„¸ìš”.</div>

  <div class="concept-info no-break">
    <h4>ğŸ“Œ íƒêµ¬ ì§ˆë¬¸ê³¼ ì•ˆë‚´ ì§ˆë¬¸ì˜ êµ¬ë¶„</h4>
    <span class="item-title">â–¸ íƒêµ¬ ì§ˆë¬¸ (Essential Question)</span>
    <span class="indent">ë‹¨ì› ì „ì²´ë¥¼ ê´€í†µí•˜ëŠ” ì—´ë¦° ì§ˆë¬¸. ì •í•´ì§„ ì •ë‹µì´ ì—†ìœ¼ë©°, ë°˜ë³µì ìœ¼ë¡œ ì¬ë°©ë¬¸í•˜ë©° ì´í•´ë¥¼ ì‹¬í™”í•œë‹¤.</span>
    <span class="item-title" style="margin-top:8px;">â–¸ ì•ˆë‚´ ì§ˆë¬¸ (Guiding Questions) â€” ì—ë¦­ìŠ¨ì˜ 3ìœ í˜•</span>
    <span class="indent">â‘  <b>ì‚¬ì‹¤ ì§ˆë¬¸ (Factual)</b>: ëˆ„ê°€, ë¬´ì—‡ì„, ì–¸ì œ, ì–´ë””ì„œ? â€” êµ¬ì²´ì  ì‚¬ì‹¤Â·ì§€ì‹ í™•ì¸</span>
    <span class="indent">â‘¡ <b>ê°œë… ì§ˆë¬¸ (Conceptual)</b>: ì™œ? ì–´ë–»ê²Œ? â€” ê°œë… ê°„ ê´€ê³„ë¥¼ íƒìƒ‰í•˜ì—¬ ì¼ë°˜í™”ì— ë„ë‹¬</span>
    <span class="indent">â‘¢ <b>ë…¼ìŸ/ì¶”ë¡  ì§ˆë¬¸ (Debatable)</b>: ê³¼ì—° ~í• ê¹Œ? â€” ê°€ì¹˜ íŒë‹¨Â·ì „ì´ë¥¼ ìœ ë„í•˜ëŠ” ì—´ë¦° ì§ˆë¬¸</span>
  </div>

  <!-- ===== Stage 2 ===== -->
  <div class="page-break"></div>
  <div class="page-label">2ë‹¨ê³„</div>

  <div class="stage-header">
    <div class="stage-badge badge-s2">2<br>ë‹¨ê³„</div>
    <div class="stage-title s2">ì¦ê±° ê²°ì •</div>
    <div class="stage-divider div-s2"></div>
  </div>

  <div class="sub-header">
    <span class="sub-num num-s2">â‘¤</span>
    <span class="sub-title">GRASPS ìˆ˜í–‰ê³¼ì œ</span>
  </div>

  <table class="t-s2">
    <thead>
      <tr>
        <th style="width:7%">ìš”ì†Œ</th>
        <th style="width:20%">ì˜ë¯¸</th>
        <th style="width:73%">ë‚´ìš©</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="grasps-letter">G</td>
        <td class="grasps-meaning">ëª©í‘œ/ë„ì „ ê³¼ì œ</td>
        <td><textarea class="autogrow" placeholder="í•™ìƒë“¤ì´ ë‹¬ì„±í•´ì•¼ í•  ëª©í‘œ ë˜ëŠ” ë„ì „ ê³¼ì œ" data-field="grasps-g"></textarea></td>
      </tr>
      <tr>
        <td class="grasps-letter">R</td>
        <td class="grasps-meaning">í•™ìƒì˜ ì—­í• </td>
        <td><textarea class="autogrow" placeholder="í•™ìƒì´ ë§¡ê²Œ ë˜ëŠ” ì—­í• " data-field="grasps-r"></textarea></td>
      </tr>
      <tr>
        <td class="grasps-letter">A</td>
        <td class="grasps-meaning">ëŒ€ìƒ/ì²­ì¤‘</td>
        <td><textarea class="autogrow" placeholder="ê²°ê³¼ë¬¼ì„ ê³µìœ í•  ëŒ€ìƒ" data-field="grasps-a"></textarea></td>
      </tr>
      <tr>
        <td class="grasps-letter">S</td>
        <td class="grasps-meaning">ì‹¤ì œì  ë§¥ë½/ìƒí™©</td>
        <td><textarea class="autogrow" placeholder="ì‹¤ì œì ì¸ ìƒí™© ë˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤" data-field="grasps-s1"></textarea></td>
      </tr>
      <tr>
        <td class="grasps-letter">P</td>
        <td class="grasps-meaning">ì‚°ì¶œë¬¼/ìˆ˜í–‰</td>
        <td><textarea class="autogrow" placeholder="ë§Œë“¤ì–´ì•¼ í•  ì‚°ì¶œë¬¼ ë˜ëŠ” ìˆ˜í–‰" data-field="grasps-p"></textarea></td>
      </tr>
      <tr>
        <td class="grasps-letter">S</td>
        <td class="grasps-meaning">í‰ê°€ ì¤€ê±°</td>
        <td><textarea class="autogrow" placeholder="í‰ê°€ì˜ ê¸°ì¤€ê³¼ ì¤€ê±°" data-field="grasps-s2"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="hint-box">ğŸ’¡ ìˆ˜í–‰ê³¼ì œëŠ” í•µì‹¬ ì•„ì´ë””ì–´ì˜ ì´í•´ë¥¼ 'ì „ì´'í•˜ì—¬ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¨ìˆœ ì•”ê¸°ë¡œ í•´ê²°ë˜ëŠ” ê³¼ì œëŠ” ìˆ˜í–‰ê³¼ì œê°€ ì•„ë‹™ë‹ˆë‹¤.</div>

  <div class="sub-header" style="margin-top:20px;">
    <span class="sub-num num-s2">â‘¥</span>
    <span class="sub-title">ë£¨ë¸Œë¦­</span>
  </div>

  <table class="t-s2" id="rubricTable">
    <thead>
      <tr>
        <th style="width:34%">í‰ê°€ ìš”ì†Œ</th>
        <th style="width:22%">ì˜í•¨ â˜…â˜…â˜…</th>
        <th style="width:22%">ë³´í†µ â˜…â˜…</th>
        <th style="width:22%">ë…¸ë ¥ ìš”í•¨ â˜…</th>
      </tr>
    </thead>
    <tbody id="rubricBody">
      <tr>
        <td><textarea class="autogrow" placeholder="í‰ê°€ ìš”ì†Œ 1" data-field="rubric-item-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì˜í•¨ ê¸°ì¤€" data-field="rubric-good-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë³´í†µ ê¸°ì¤€" data-field="rubric-avg-1"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë…¸ë ¥ ìš”í•¨ ê¸°ì¤€" data-field="rubric-low-1"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="í‰ê°€ ìš”ì†Œ 2" data-field="rubric-item-2"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì˜í•¨ ê¸°ì¤€" data-field="rubric-good-2"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë³´í†µ ê¸°ì¤€" data-field="rubric-avg-2"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë…¸ë ¥ ìš”í•¨ ê¸°ì¤€" data-field="rubric-low-2"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="í‰ê°€ ìš”ì†Œ 3" data-field="rubric-item-3"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì˜í•¨ ê¸°ì¤€" data-field="rubric-good-3"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë³´í†µ ê¸°ì¤€" data-field="rubric-avg-3"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë…¸ë ¥ ìš”í•¨ ê¸°ì¤€" data-field="rubric-low-3"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="table-actions no-print">
    <button class="add-row-btn" onclick="addRow('rubricBody', ['rubric-item','rubric-good','rubric-avg','rubric-low'], 4)">+ í‰ê°€ ìš”ì†Œ ì¶”ê°€</button>
  </div>
  <div class="hint-box">ğŸ’¡ ë£¨ë¸Œë¦­ì˜ í‰ê°€ ìš”ì†ŒëŠ” ìˆ˜í–‰ê³¼ì œì˜ ì¤€ê±°(S)ì—ì„œ ë„ì¶œí•©ë‹ˆë‹¤. ì§€ì‹Â·ì´í•´(Know) / ê³¼ì •Â·ê¸°ëŠ¥(Do) / ê°€ì¹˜Â·íƒœë„(Be)ë¥¼ ê³ ë¥´ê²Œ ë°˜ì˜í•˜ì„¸ìš”.</div>

  <!-- ===== Stage 3 ===== -->
  <div class="page-break"></div>
  <div class="page-label">3ë‹¨ê³„</div>

  <div class="stage-header">
    <div class="stage-badge badge-s3">3<br>ë‹¨ê³„</div>
    <div class="stage-title s3">í•™ìŠµ ê²½í—˜ ê³„íš</div>
    <div class="stage-divider div-s3"></div>
  </div>

  <div class="sub-header">
    <span class="sub-num num-s3">â‘¦</span>
    <span class="sub-title">ë‹¨ì› í•™ìŠµ íë¦„</span>
  </div>
  <p class="desc-text">ìŠ¤íŠ¸ëœë“œë³„ ì£¼ìš” í™œë™ê³¼ ì•ˆë‚´ ì§ˆë¬¸ì„ ê¸°ë¡í•˜ì„¸ìš”.</p>

  <table class="t-s3" id="flowTable">
    <thead>
      <tr>
        <th style="width:9%">ì°¨ì‹œ</th>
        <th style="width:18%">ìŠ¤íŠ¸ëœë“œ<br>(ì£¼ì œëª…)</th>
        <th style="width:36%">ì£¼ìš” í™œë™</th>
        <th style="width:25%">ì•ˆë‚´ ì§ˆë¬¸</th>
        <th style="width:12%">ë¹„ê³ </th>
      </tr>
    </thead>
    <tbody id="flowBody">
      <tr>
        <td><textarea class="autogrow" placeholder="1" data-field="flow-h-1" style="text-align:center;min-height:56px;"></textarea></td>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 1" data-field="flow-strand-1" style="text-align:center;font-weight:700;color:#B87333;min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì£¼ìš” í™œë™ ì…ë ¥" data-field="flow-act-1" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸" data-field="flow-q-1" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-note-1" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="2" data-field="flow-h-2" style="text-align:center;min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-strand-2" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì£¼ìš” í™œë™ ì…ë ¥" data-field="flow-act-2" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸" data-field="flow-q-2" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-note-2" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="3" data-field="flow-h-3" style="text-align:center;min-height:56px;"></textarea></td>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 2" data-field="flow-strand-3" style="text-align:center;font-weight:700;color:#B87333;min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì£¼ìš” í™œë™ ì…ë ¥" data-field="flow-act-3" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸" data-field="flow-q-3" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-note-3" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="4" data-field="flow-h-4" style="text-align:center;min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-strand-4" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì£¼ìš” í™œë™ ì…ë ¥" data-field="flow-act-4" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸" data-field="flow-q-4" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-note-4" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td><textarea class="autogrow" placeholder="5" data-field="flow-h-5" style="text-align:center;min-height:56px;"></textarea></td>
        <td class="strand-label"><textarea class="autogrow" placeholder="ìŠ¤íŠ¸ëœë“œ 3" data-field="flow-strand-5" style="text-align:center;font-weight:700;color:#B87333;min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì£¼ìš” í™œë™ ì…ë ¥" data-field="flow-act-5" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ì•ˆë‚´ ì§ˆë¬¸" data-field="flow-q-5" style="min-height:56px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="" data-field="flow-note-5" style="min-height:56px;"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="table-actions no-print">
    <button class="add-row-btn" onclick="addFlowRow()">+ ì°¨ì‹œ í–‰ ì¶”ê°€</button>
  </div>
  <div class="hint-box">ğŸ’¡ ì¼ë°˜í™”(ê°œë… ì •ë¦¬) â†’ ì „ì´(ìƒˆë¡œìš´ ìƒí™© ì ìš©)ëŠ” ë°˜ë“œì‹œ êµ¬ë¶„í•˜ì„¸ìš”. ìˆ˜í–‰ê³¼ì œëŠ” 'ì „ì´í•˜ê¸°' ë‹¨ê³„ì— ìœ„ì¹˜í•©ë‹ˆë‹¤.</div>

  <!-- ===== Page 5 ===== -->
  <div class="page-break"></div>
  <div class="page-label">3ë‹¨ê³„ ê³„ì†</div>

  <div class="sub-header">
    <span class="sub-num num-s3">â‘§</span>
    <span class="sub-title">WHERETO ìê¸° ì ê²€ (Wiggins &amp; McTighe)</span>
  </div>
  <p class="desc-text">í•™ìŠµ ê²½í—˜ì´ ì•„ë˜ 7ê°€ì§€ ìš”ì†Œë¥¼ ì¶©ì¡±í•˜ëŠ”ì§€ ì ê²€í•˜ì„¸ìš”.</p>

  <table class="t-s3">
    <thead>
      <tr>
        <th style="width:6%">ìš”ì†Œ</th>
        <th style="width:20%">ì˜ë¯¸</th>
        <th style="width:44%">ì ê²€ ì§ˆë¬¸</th>
        <th style="width:30%">ë©”ëª¨</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="whereto-letter">W</td>
        <td class="whereto-meaning"><b>Where &amp; Why</b><br><span style="font-size:8pt;color:var(--gray-500);">(ë°©í–¥ê³¼ ì´ìœ )</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•™ìƒì´ ë‹¨ì›ì˜ ë°©í–¥Â·ëª©í‘œÂ·í‰ê°€ ê¸°ì¤€ì„ ì•Œê³  ìˆëŠ”ê°€?<br>'ì™œ ì´ê²ƒì„ ë°°ìš°ëŠ”ê°€'ë¥¼ ì´í•´í•˜ëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-w" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">H</td>
        <td class="whereto-meaning"><b>Hook &amp; Hold</b><br><span style="font-size:8pt;color:var(--gray-500);">(ëª°ì… ìœ ë„)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">ë„ì…ì—ì„œ í•™ìƒì˜ í¥ë¯¸Â·í˜¸ê¸°ì‹¬ì„ ëŒì–´ë‚´ëŠ” í™œë™ì´ ìˆëŠ”ê°€?<br>í•™ìŠµ ì „ë°˜ì— ê±¸ì³ ëª°ì…ì´ ìœ ì§€ë˜ëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-h" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">E<sub>1</sub></td>
        <td class="whereto-meaning"><b>Explore &amp; Experience</b><br><span style="font-size:8pt;color:var(--gray-500);">(íƒìƒ‰Â·ê²½í—˜)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•µì‹¬ ì•„ì´ë””ì–´ë¥¼ í•™ìƒ ìŠ¤ìŠ¤ë¡œ íƒêµ¬Â·ê²½í—˜í•  ê¸°íšŒê°€ ìˆëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-e1" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">R</td>
        <td class="whereto-meaning"><b>Reflect, Rethink, Revise</b><br><span style="font-size:8pt;color:var(--gray-500);">(ì„±ì°°Â·ì¬ê³ Â·ìˆ˜ì •)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•™ìƒì´ ìì‹ ì˜ ì´í•´ë¥¼ ëŒì•„ë³´ê³  ìˆ˜ì •í•  ê¸°íšŒê°€ ìˆëŠ”ê°€?<br>ì˜¤ê°œë…ì„ ì ê²€í•˜ê³  ì¬ì‚¬ê³ í•˜ëŠ” í™œë™ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-r" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">E<sub>2</sub></td>
        <td class="whereto-meaning"><b>Evaluate</b><br><span style="font-size:8pt;color:var(--gray-500);">(ìê¸° í‰ê°€)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•™ìƒì´ ìì‹ ì˜ í•™ìŠµ ê³¼ì •ê³¼ ê²°ê³¼ë¥¼ ìŠ¤ìŠ¤ë¡œ í‰ê°€í•  ìˆ˜ ìˆëŠ”ê°€?<br>í˜•ì„± í‰ê°€ê°€ ì ì ˆíˆ ë°°ì¹˜ë˜ì–´ ìˆëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-e2" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">T</td>
        <td class="whereto-meaning"><b>Tailored</b><br><span style="font-size:8pt;color:var(--gray-500);">(ê°œë³„í™”)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•™ìƒì˜ ê°œì¸ì°¨(í¥ë¯¸Â·ìˆ˜ì¤€Â·í•™ìŠµ ì–‘ì‹)ì— ë”°ë¼<br>í™œë™ì´ë‚˜ ìë£Œê°€ ì°¨ë³„í™”ë˜ì–´ ìˆëŠ”ê°€?</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-t" style="min-height:56px;"></textarea></td>
      </tr>
      <tr>
        <td class="whereto-letter">O</td>
        <td class="whereto-meaning"><b>Organized</b><br><span style="font-size:8pt;color:var(--gray-500);">(ì¡°ì§Â·ë°°ì—´)</span></td>
        <td style="padding:8px 10px;font-size:9pt;vertical-align:middle;">í•™ìŠµ í™œë™ì´ ì´í•´ì˜ ì‹¬í™”ë¥¼ ìœ„í•´ ìµœì ì˜ ìˆœì„œë¡œ ë°°ì—´ë˜ì–´ ìˆëŠ”ê°€?<br>(ë‹¨ìˆœ ì‹œê°„ìˆœì´ ì•„ë‹Œ ê°œë…ì  íë¦„ ì¤‘ì‹¬)</td>
        <td><textarea class="autogrow" placeholder="í•´ë‹¹ ì°¨ì‹œ / ë©”ëª¨" data-field="whereto-o" style="min-height:56px;"></textarea></td>
      </tr>
    </tbody>
  </table>
  <div class="hint-box">ğŸ’¡ WHERETOëŠ” ìœ„ê¸´ìŠ¤ì™€ ë§¥íƒ€ì´ì˜ 'ì´í•´ì¤‘ì‹¬êµìœ¡ê³¼ì •(UbD)' 3ë‹¨ê³„ì—ì„œ í•™ìŠµ ê²½í—˜ì„ ì„¤ê³„Â·ì ê²€í•˜ëŠ” í‹€ì…ë‹ˆë‹¤.</div>

  <!-- ===== KPT ===== -->
  <div class="sub-header" style="margin-top:24px;">
    <span class="sub-num" style="background:var(--gray-700);">âœ</span>
    <span class="sub-title">ì‚¬í›„ íŒ€ ì„±ì°° (KPT)</span>
  </div>

  <table class="t-kpt">
    <thead>
      <tr>
        <th style="width:33%;">Keep<br><span style="font-weight:normal;font-size:8pt;">ì˜ ëœ ì </span></th>
        <th style="width:34%;">Problem<br><span style="font-weight:normal;font-size:8pt;">ë³´ì™„í•  ì </span></th>
        <th style="width:33%;">Try<br><span style="font-weight:normal;font-size:8pt;">ë‹¤ìŒ ì‹œë„</span></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><textarea class="autogrow" placeholder="ì˜ ëœ ì ì„ ê¸°ë¡í•˜ì„¸ìš”" data-field="kpt-keep" style="min-height:120px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë³´ì™„í•  ì ì„ ê¸°ë¡í•˜ì„¸ìš”" data-field="kpt-problem" style="min-height:120px;"></textarea></td>
        <td><textarea class="autogrow" placeholder="ë‹¤ìŒì— ì‹œë„í•  ê²ƒì„ ê¸°ë¡í•˜ì„¸ìš”" data-field="kpt-try" style="min-height:120px;"></textarea></td>
      </tr>
    </tbody>
  </table>

  <!-- ===== Footer ===== -->
  <div class="footer-bar">
    <span class="left">ë£°ë£¨ë„ë¼ í•œê¸°ìŒ¤</span>
    <span class="right">ê°œë…ê¸°ë°˜ìˆ˜ì—…ì„¤ê³„ AIë¡œ ë‚ ê°œë¥¼ ë‹¬ë‹¤</span>
  </div>

</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
// ===== Row Counter =====
let rowCounters = {};

// ===== Auto-grow textareas =====
function autoGrow(el) {
  el.style.height = 'auto';
  el.style.height = el.scrollHeight + 'px';
}

document.addEventListener('input', function(e) {
  if (e.target.tagName === 'TEXTAREA') {
    autoGrow(e.target);
    scheduleSave();
  }
});

// Initialize all textareas
function initAutoGrow() {
  document.querySelectorAll('textarea').forEach(el => {
    autoGrow(el);
    el.addEventListener('focus', () => autoGrow(el));
  });
}

// ===== Toast =====
function showToast(msg, duration = 2500) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), duration);
}

// ===== Add Generic Row =====
function addRow(tbodyId, prefixes, colCount) {
  const tbody = document.getElementById(tbodyId);
  const rowNum = tbody.rows.length + 1;
  const tr = document.createElement('tr');

  for (let i = 0; i < colCount; i++) {
    const td = document.createElement('td');
    if (i === colCount - 1 && tbodyId === 'basicInfoBody') {
      td.className = 'cell-center';
    }
    const ta = document.createElement('textarea');
    ta.className = 'autogrow';
    ta.dataset.field = `${prefixes[i]}-${rowNum}`;
    ta.placeholder = '';
    if (i === colCount - 1 && tbodyId === 'basicInfoBody') {
      ta.style.textAlign = 'center';
    }
    td.appendChild(ta);
    tr.appendChild(td);
  }

  tbody.appendChild(tr);
  initAutoGrow();
  showToast('í–‰ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
}

// ===== Add Strand Row =====
function addStrandRow() {
  const tbody = document.getElementById('strandBody');
  const num = tbody.rows.length + 1;
  const tr = document.createElement('tr');

  const tdName = document.createElement('td');
  tdName.className = 'strand-label';
  const taName = document.createElement('textarea');
  taName.className = 'autogrow';
  taName.placeholder = `ìŠ¤íŠ¸ëœë“œ ${num}`;
  taName.dataset.field = `strand-name-${num}`;
  taName.style.cssText = 'text-align:center;font-weight:700;color:#B87333;min-height:60px;';
  tdName.appendChild(taName);
  tr.appendChild(tdName);

  const tdIdea = document.createElement('td');
  const taIdea = document.createElement('textarea');
  taIdea.className = 'autogrow';
  taIdea.placeholder = 'í•˜ìœ„ ì•„ì´ë””ì–´(ì¼ë°˜í™”) ì…ë ¥';
  taIdea.dataset.field = `strand-idea-${num}`;
  taIdea.style.minHeight = '60px';
  tdIdea.appendChild(taIdea);
  tr.appendChild(tdIdea);

  const tdQ = document.createElement('td');
  const taQ = document.createElement('textarea');
  taQ.className = 'autogrow';
  taQ.placeholder = 'ì•ˆë‚´ ì§ˆë¬¸ 2~4ê°œ ì…ë ¥';
  taQ.dataset.field = `strand-q-${num}`;
  taQ.style.minHeight = '60px';
  tdQ.appendChild(taQ);
  tr.appendChild(tdQ);

  tbody.appendChild(tr);
  initAutoGrow();
  showToast('ìŠ¤íŠ¸ëœë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
}

// ===== Add Flow Row =====
function addFlowRow() {
  const tbody = document.getElementById('flowBody');
  const num = tbody.rows.length + 1;
  const tr = document.createElement('tr');

  const fields = [
    { prefix: 'flow-h', placeholder: `${num}`, style: 'text-align:center;min-height:56px;' },
    { prefix: 'flow-strand', placeholder: '', style: 'min-height:56px;' },
    { prefix: 'flow-act', placeholder: 'ì£¼ìš” í™œë™ ì…ë ¥', style: 'min-height:56px;' },
    { prefix: 'flow-q', placeholder: 'ì•ˆë‚´ ì§ˆë¬¸', style: 'min-height:56px;' },
    { prefix: 'flow-note', placeholder: '', style: 'min-height:56px;' }
  ];

  fields.forEach(f => {
    const td = document.createElement('td');
    const ta = document.createElement('textarea');
    ta.className = 'autogrow';
    ta.placeholder = f.placeholder;
    ta.dataset.field = `${f.prefix}-${num}`;
    ta.style.cssText = f.style;
    td.appendChild(ta);
    tr.appendChild(td);
  });

  tbody.appendChild(tr);
  initAutoGrow();
  showToast('ì°¨ì‹œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
}

// ===== Local Storage Save/Load =====
const STORAGE_KEY = 'cbci-web-worksheet-v1';
let saveTimer = null;

function scheduleSave() {
  clearTimeout(saveTimer);
  saveTimer = setTimeout(saveData, 1000);
  document.getElementById('saveIcon').textContent = 'â³';
  document.getElementById('saveText').textContent = 'ì €ì¥ ì¤‘...';
  document.getElementById('saveStatus').classList.remove('saved');
}

function saveData() {
  const data = {};
  document.querySelectorAll('textarea[data-field]').forEach(el => {
    data[el.dataset.field] = el.value;
  });
  // Save checkbox states
  document.querySelectorAll('input[type="checkbox"][data-field]').forEach(el => {
    data[el.dataset.field] = el.checked;
  });
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    document.getElementById('saveIcon').textContent = 'âœ…';
    document.getElementById('saveText').textContent = 'ìë™ ì €ì¥ë¨';
    document.getElementById('saveStatus').classList.add('saved');
  } catch (e) {
    document.getElementById('saveIcon').textContent = 'âš ï¸';
    document.getElementById('saveText').textContent = 'ì €ì¥ ì‹¤íŒ¨';
  }
}

function loadData() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return;
    const data = JSON.parse(raw);
    Object.entries(data).forEach(([field, value]) => {
      const el = document.querySelector(`textarea[data-field="${field}"]`);
      if (el) {
        el.value = value;
        autoGrow(el);
      }
      const cb = document.querySelector(`input[data-field="${field}"]`);
      if (cb) cb.checked = value;
    });
    document.getElementById('saveIcon').textContent = 'âœ…';
    document.getElementById('saveText').textContent = 'ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ';
    document.getElementById('saveStatus').classList.add('saved');
  } catch (e) {
    console.warn('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', e);
  }
}

// ===== Reset =====
function resetAll() {
  if (!confirm('ëª¨ë“  ì…ë ¥ ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
  document.querySelectorAll('textarea').forEach(el => {
    el.value = '';
    autoGrow(el);
  });
  document.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);
  localStorage.removeItem(STORAGE_KEY);
  document.getElementById('saveIcon').textContent = 'ğŸ’¾';
  document.getElementById('saveText').textContent = 'ì´ˆê¸°í™”ë¨';
  document.getElementById('saveStatus').classList.remove('saved');
  showToast('ëª¨ë“  ë‚´ìš©ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤');
}

// ===== Download HTML =====
function downloadHTML() {
  // Clone the document
  const clone = document.documentElement.cloneNode(true);

  // Remove toolbar and no-print elements from clone
  clone.querySelectorAll('.toolbar, .no-print, .toast').forEach(el => el.remove());

  // Replace textareas with their values as styled divs
  clone.querySelectorAll('textarea').forEach(ta => {
    const div = document.createElement('div');
    div.style.cssText = ta.style.cssText || '';
    div.style.padding = '8px 10px';
    div.style.fontSize = '9.5pt';
    div.style.lineHeight = '1.65';
    div.style.whiteSpace = 'pre-wrap';
    div.style.wordBreak = 'break-word';
    div.style.minHeight = ta.style.minHeight || '48px';

    // Get current value from the original document
    const field = ta.dataset.field;
    const originalTa = document.querySelector(`textarea[data-field="${field}"]`);
    const val = originalTa ? originalTa.value : ta.value;

    if (val) {
      div.textContent = val;
      div.style.color = '#1a1a1a';
    } else {
      div.textContent = ta.placeholder || '';
      div.style.color = '#999';
      div.style.fontStyle = 'italic';
    }
    ta.parentNode.replaceChild(div, ta);
  });

  // Replace checkboxes
  clone.querySelectorAll('input[type="checkbox"]').forEach(cb => {
    const span = document.createElement('span');
    const field = cb.dataset.field;
    const originalCb = document.querySelector(`input[data-field="${field}"]`);
    span.textContent = (originalCb && originalCb.checked) ? 'â˜‘' : 'â˜';
    span.style.fontSize = '14px';
    cb.parentNode.replaceChild(span, cb);
  });

  const html = '<!DOCTYPE html>\n<html lang="ko">\n' + clone.outerHTML + '\n</html>';

  const blob = new Blob([html], { type: 'text/html;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');

  const projectName = document.querySelector('textarea[data-field="project-name"]')?.value || 'ê°œë…ê¸°ë°˜_í”„ë¡œì íŠ¸_ì„¤ê³„';
  const date = new Date().toISOString().slice(0, 10);
  a.download = `${projectName.replace(/\s+/g, '_')}_${date}.html`;
  a.href = url;
  a.click();
  URL.revokeObjectURL(url);
  showToast('HTML íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤');
}

// ===== Print / PDF =====
function printPDF() {
  window.print();
}

// ===== Init =====
window.addEventListener('DOMContentLoaded', () => {
  loadData();
  initAutoGrow();
});
</script>

</body>
</html>
